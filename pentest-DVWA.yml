# pentest-DVWA.yml
# Michael He
#
# Ansible playbook to install the Damn Vulnerable Web Application (DVWA), a PHP/MySQL web application
# used for penetration and application security testing. It contains several OWASP Top 10 web application
# security vulnerabilities.
#
# Disclaimer: This is a vulnerable web application for instructional use only. Do not deploy this
# application to any public servers.
#
# Tested on the Microsoft Azure cloud computing platform.
#
# Compatibility: Linux
# Requirements: Docker, Ansible, Python

---
  - name: Configure Ubuntu virtual machine on Azure
    hosts: webservers
    become: true
    tasks:

      - name: Install docker.io
        apt:
          update_cache: yes
          name: docker.io
          state: present

      - name: Install pip3
        apt:
          force_apt_get: yes
          name: python3-pip
          state: present

      - name: Install Python Docker module
        pip:
          name: docker
          state: present

# cyberxsecurity/dvwa is a docker container that provides the DVWA image
      - name: Download and launch a docker web container called DVWA
        docker_container:
          name: dvwa
          image: cyberxsecurity/dvwa
          state: started
          restart_policy: always
          published_ports: 80:80

      - name: Enable docker service
        systemd:
          name: docker
          enabled: yes